(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{111:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),o=n(22),a=n.n(o),i=n(2),s=n(21),l=n.n(s),u=n(4),d=n(24),j=(n(109),n(0)),b=function(e){return Object(j.jsx)(i.g,{children:Object(j.jsx)(i.c,{disabled:e.disabled,stretched:e.stretched,mode:e.mode,onClick:e.onClick,size:e.size,children:e.text})})},O=function(e){var t=e.name,n=e.status,c=e.value,r=e.placeholder,o=e.onChange,a=e.type,s=void 0===a?"text":a,l=e.required;return Object(j.jsx)(i.g,{children:Object(j.jsx)(i.o,{name:t,status:n,value:c,placeholder:r,onChange:function(e){var t=e.target;return o(t.value)},type:s,required:l})})},f=function(e){var t=e.inputs,n=e.mode;return Object(j.jsx)(i.i,{mode:n,children:Object.keys(t).map((function(e){return Object(j.jsx)(O,{status:t[e].status,name:e,value:t[e].value,placeholder:t[e].placeholder,onChange:t[e].onChange,type:t[e].type?t[e].type:"text",required:t[e].required},e)}))})},h=function(e){return Object(j.jsxs)(i.h,{children:[Object(j.jsx)(f,{inputs:{username:{value:e.username,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",onChange:e.onUsernameChange,required:!0},password:{value:e.password,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",onChange:e.onPasswordChange,required:!0,type:"password"}}}),Object(j.jsx)(b,{text:"\u0412\u0445\u043e\u0434",mode:"primary",stretched:!0,onClick:e.onButtonClick})]})},x=n(112),v=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(""),s=Object(u.a)(a,2),l=s[0],d=s[1];return Object(j.jsxs)(i.H,{style:e.style,children:[Object(j.jsxs)(i.G,{width:"250px",maxWidth:"250px",children:[Object(j.jsx)(i.F,{}),Object(j.jsx)(h,{username:r,password:l,onUsernameChange:o,onPasswordChange:d,onButtonClick:function(){return e.onButtonClick(r,l)}})]}),Object(j.jsx)(i.G,{animate:!1,spaced:!0,width:"560px",maxWidth:"900px",children:Object(j.jsx)(i.B,{icon:Object(j.jsx)(x.a,{}),stretched:!0,header:"\u0414\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})})]})},p=n(113),m=function(e){return Object(j.jsx)(i.g,{children:Object(j.jsx)(i.s,{required:e.required,status:e.status,placeholder:e.placeholder,name:e.name,value:e.value,onChange:function(t){var n=t.target;return e.onChange(n.value)},children:e.values.map((function(e){return Object(j.jsx)("option",{value:e,children:e},e)}))})})};var k=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){return function(e){fetch("loda/roles").then((function(e){return e.json()})).then((function(t){var n=t.data;return e(n)}))}(o)}),[]),Object(j.jsx)(m,{status:e.status,required:e.required,name:e.name,values:r?Object.keys(r):[],value:e.role,onChange:e.setRole,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c"})};var C=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1];function a(t){e.setDepartment(t),e.setGroup("")}return Object(c.useEffect)((function(){return function(e){fetch("loda/university").then((function(e){return e.json()})).then((function(t){var n=t.data;return e(n)}))}(o)}),[]),Object(j.jsxs)(i.i,{mode:e.mode,children:[Object(j.jsx)(m,{required:e.required,status:e.status,name:"faculty",values:Object.keys(r),value:e.faculty,onChange:function(t){e.setFaculty(t),e.facultyOnly||a("")},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442"}),!e.facultyOnly&&e.faculty?Object(j.jsx)(m,{required:e.required,status:e.status,name:"department",values:Object.keys(r[e.faculty]),value:e.department,onChange:a,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u0444\u0435\u0434\u0440\u0443"}):"",e.department?Object(j.jsx)(m,{required:e.required,status:e.status,name:"group",values:r[e.faculty][e.department],value:e.group,onChange:e.setGroup,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u0440\u0443\u043f\u043f\u0443"}):""]})},y=function(e){return Object(j.jsxs)(i.i,{children:[Object(j.jsx)(k,{role:e.role,setRole:e.setRole}),Object(j.jsx)(C,{mode:e.universityMode,faculty:e.faculty,setFaculty:e.setFaculty,facultyOnly:e.facultyOnly,department:e.department,setDepartment:e.setDepartment,group:e.group,setGroup:e.setGroup})]})},I=function(e){return Object(j.jsxs)(i.i,{mode:"horizontal",children:[Object(j.jsx)(O,{name:"lastName",placeholder:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",value:e.lastName,onChange:e.setLastName}),Object(j.jsx)(O,{name:"firstName",placeholder:"\u0418\u043c\u044f",value:e.firstName,onChange:e.setFirstName}),Object(j.jsx)(O,{name:"surname",placeholder:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",value:e.surname,onChange:e.setSurname})]})},S=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(""),s=Object(u.a)(a,2),O=s[0],f=s[1],h=Object(c.useState)(""),x=Object(u.a)(h,2),v=x[0],p=x[1],m=Object(c.useState)(""),k=Object(u.a)(m,2),C=k[0],S=k[1],A=Object(c.useState)(""),g=Object(u.a)(A,2),M=g[0],P=g[1],E=Object(c.useState)(""),R=Object(u.a)(E,2),_=R[0],N=R[1],B=Object(c.useState)(""),L=Object(u.a)(B,2),q=L[0],T=L[1];function w(e){return D.apply(this,arguments)}function D(){return(D=Object(d.a)(l.a.mark((function t(n){var c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),c={},r&&(c.firstName=r),O&&(c.lastName=O),v&&(c.middleName=v),C&&(c.role=C),M&&(c.faculty=M),_&&(c.department=_),q&&(c.group=q),e.setBody(c);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(j.jsxs)(i.h,{name:"filterQuery",onSubmit:w,children:[Object(j.jsx)(I,{firstName:r,setFirstName:o,lastName:O,setLastName:f,surname:v,setSurname:p}),Object(j.jsx)(y,{role:C,setRole:S,faculty:M,setFaculty:P,department:_,setDepartment:N,group:q,setGroup:T}),Object(j.jsx)(b,{stretched:!0,mode:"primary",onClick:w,size:"l",text:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440"})]})},A=function(e){var t=e.readerList,n=e.openReaderInfo;return Object(j.jsx)(i.j,{header:Object(j.jsxs)(i.k,{children:["\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ",t.count]}),mode:"plain",children:null===t||void 0===t?void 0:t.data.map((function(e){return Object(j.jsx)(g,{reader:e,openReaderInfo:n},e.Id)}))})},g=function(e){var t,n=e.reader,c=e.openReaderInfo;return Object(j.jsx)(i.E,{after:Object(j.jsx)(p.a,{}),onClick:function(){return c(n.Id)},children:Object(j.jsx)(i.l,{weight:"medium",children:"".concat(n.Surname," ").concat(n.Name," ").concat(null!==(t=n.Mid_name)&&void 0!==t?t:"")})})},M=function(e){var t=Object(c.useState)(!0),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)({}),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)(null),O=Object(u.a)(b,2),f=O[0],h=O[1];return Object(c.useEffect)((function(){fetch("".concat("loda","/readers/query"),{method:"POST",body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(t){h(Object(j.jsx)(A,{readerList:t,openReaderInfo:e.openReaderInfo})),o(!1)})).catch((function(e){console.error(e),o(!1)}))}),[l]),Object(j.jsxs)(i.t,{id:e.id,children:[Object(j.jsx)(i.u,{left:Object(j.jsx)(i.w,{onClick:e.addReaderButtonClick,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044f"}),children:"\u0421\u043f\u0438\u0441\u043e\u043a \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"}),Object(j.jsxs)(i.j,{children:[r?Object(j.jsx)(i.A,{height:96,size:"large"}):f?Object(j.jsx)(S,{setBody:d}):Object(j.jsx)(i.B,{icon:Object(j.jsx)(x.a,{}),header:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445"}),f]})]})},P=n(115),E=n(114),R=function(e){var t=e.header,n=void 0===t?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445":t;return Object(j.jsx)(i.B,{icon:Object(j.jsx)(E.a,{}),header:n})};var _=function(e){var t,n=e.props,r=e.setPlaceholder,o=Object(c.useState)(n.firstName),a=Object(u.a)(o,2),s=a[0],l=a[1],d=Object(c.useState)(n.lastName),O=Object(u.a)(d,2),h=O[0],x=O[1],v=Object(c.useState)(n.middleName),p=Object(u.a)(v,2),m=p[0],y=p[1],I=Object(c.useState)(n.role),S=Object(u.a)(I,2),A=S[0],g=S[1],M=Object(c.useState)(""),P=Object(u.a)(M,2),E=P[0],_=P[1],N=Object(c.useState)(""),B=Object(u.a)(N,2),L=B[0],q=B[1],T=Object(c.useState)(""),w=Object(u.a)(T,2),D=w[0],z=w[1];return Object(j.jsxs)(i.h,{name:"addReader",children:[Object(j.jsx)(f,{inputs:{addReaderLasttName:{value:h,onChange:x,placeholder:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",required:!0},addReaderFirstName:{value:s,onChange:l,placeholder:"\u0418\u043c\u044f",required:!0},addReaderMiddleName:{value:m,onChange:y,placeholder:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e"}},mode:"horizontal"}),Object(j.jsx)(k,{role:A,setRole:g,required:!0,status:A?"valid":"error"}),Object(j.jsx)(C,{faculty:E,setFaculty:_,department:L,setDepartment:q,group:D,setGroup:z}),Object(j.jsx)(b,{stretched:!0,mode:"primary",onClick:function(){if(A){var e={firstName:s,lastName:h,middleName:""!==m?m:null,role:A,faculty:""===E?null:E,department:""===L?null:L,group:""===D?null:D};n.onClick?n.onClick(e):function(e,t){fetch("loda/readers",{method:"POST",body:JSON.stringify(e)}).then((function(e){return e.ok?t(Object(j.jsx)(i.B,{header:"\u0427\u0438\u0442\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d"})):t(Object(j.jsx)(i.B,{header:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044f"}))})).catch((function(e){return t(Object(j.jsx)(R,{}))}))}(e,r)}},size:"l",text:null!==(t=n.text)&&void 0!==t?t:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})},N=function(e){var t,n,r,o,a=e.reader,s=Object(c.useState)(null),l=Object(u.a)(s,2),d=l[0],b=l[1];return null!==d&&void 0!==d?d:Object(j.jsx)(_,{props:{firstName:a.Name,lastName:a.Surname,middleName:null!==(t=a.Mid_name)&&void 0!==t?t:"",role:a.Role,faculty:null!==(n=a.Faculty)&&void 0!==n?n:"",department:null!==(r=a.Department)&&void 0!==r?r:"",group:null!==(o=a.Group)&&void 0!==o?o:"",onClick:function(e){fetch("loda/readers/"+a.Id,{method:"PUT",body:JSON.stringify(e)}).then((function(e){return e.ok?b(Object(j.jsx)(i.B,{header:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430"})):b(Object(j.jsx)(i.B,{header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e"}))})).catch((function(e){return b(Object(j.jsx)(R,{}))}))},text:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e"}})},B=function(e){var t,n,c,r;return Object(j.jsxs)(i.j,{header:Object(j.jsx)(i.k,{children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}),mode:"card",children:[Object(j.jsx)(L,{after:e.reader.Issued?Object(j.jsx)(P.a,{}):null,indicator:null!==(t=e.reader.Issued)&&void 0!==t?t:0,text:"\u041a\u043d\u0438\u0433 \u043d\u0430 \u0440\u0443\u043a\u0430\u0445",onClick:function(){return e.setActiveModal("issuedBooksList")},disabled:!e.reader.Issued}),Object(j.jsx)(L,{after:e.reader.Lost?Object(j.jsx)(P.a,{}):null,indicator:null!==(n=e.reader.Lost)&&void 0!==n?n:0,onClick:function(){return e.setActiveModal("lostBooksList")},text:"\u041f\u043e\u0442\u0435\u0440\u044f\u043d\u043e \u043a\u043d\u0438\u0433",disabled:!e.reader.Lost}),Object(j.jsx)(L,{after:e.reader.Total_infractions?Object(j.jsx)(P.a,{}):null,indicator:null!==(c=e.reader.Total_infractions)&&void 0!==c?c:0,onClick:function(){return e.setActiveModal("issuedInfractionsList")},text:"\u041d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0439",disabled:!e.reader.Total_infractions}),Object(j.jsx)(L,{after:e.reader.Active_infractions?Object(j.jsx)(P.a,{}):null,indicator:null!==(r=e.reader.Active_infractions)&&void 0!==r?r:0,onClick:function(){return e.setActiveModal("activeInfractionsList")},text:"\u0418\u0437 \u043d\u0438\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445",disabled:!e.reader.Active_infractions})]})},L=function(e){return null!==e.indicator?Object(j.jsx)(i.E,{before:e.before,after:e.after,disabled:e.disabled,indicator:e.indicator,onClick:e.onClick,children:e.text}):""},q=function(e){var t=e.canEditInfo,n=e.reader,c=e.editReaderInfo;return Object(j.jsxs)(i.j,{mode:"card",children:[Object(j.jsx)(L,{disabled:!0,indicator:n.Role,text:"\u0414\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c"}),Object(j.jsx)(L,{disabled:!0,indicator:n.Faculty,text:"\u0424\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442"}),Object(j.jsx)(L,{disabled:!0,indicator:n.Department,text:"\u041a\u0430\u0444\u0435\u0434\u0440\u0430"}),Object(j.jsx)(L,{disabled:!0,indicator:n.Group,text:"\u0413\u0440\u0443\u043f\u043f\u0430"}),t?Object(j.jsx)(i.e,{onClick:c,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e"}):null]})},T=function(e){return Object(j.jsxs)(i.j,{separator:!0,children:[Object(j.jsx)(q,{canEditInfo:e.canEditInfo,reader:e.reader,editReaderInfo:e.editReaderInfo}),Object(j.jsx)(B,{reader:e.reader,setActiveModal:e.setActiveModal})]})};var w=function(e){var t,n=Object(c.useState)(null),r=Object(u.a)(n,2),o=r[0],a=r[1],s=Object(c.useState)(!1),l=Object(u.a)(s,2),d=l[0],b=l[1],O=Object(c.useState)(!1),f=Object(u.a)(O,2),h=f[0],x=f[1];return Object(c.useEffect)((function(){fetch("loda"+"/readers/".concat(e.readerId)).then((function(e){return e.json()})).then((function(e){var t=e.data;return a(t[0])}))}),[e.readerId,d]),Object(j.jsxs)(i.p,{id:e.id,onClose:e.onClose,settlingHeight:100,children:[Object(j.jsx)(i.q,{left:d?Object(j.jsx)(i.v,{onClick:function(){return b(!1)}}):"",right:d?h?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(i.x,{onClick:function(){return x(!1)}}),Object(j.jsx)(i.y,{isActive:!0,onClick:function(){return t=o.Id,n=e.setActiveModal,void fetch("loda/readers/"+t,{method:"DELETE"}).then((function(e){return n(null)}));var t,n}})]}):Object(j.jsx)(i.w,{onClick:function(){return x(!0)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}):"",children:o?"".concat(o.Surname," ").concat(o.Name," ").concat(null!==(t=o.Mid_name)&&void 0!==t?t:""):""}),o?d?Object(j.jsx)(N,{reader:o}):Object(j.jsx)(T,{canEditInfo:!0,reader:o,editReaderInfo:function(){return b(!0)},setActiveModal:e.setActiveModal}):""]})},D=function(e){var t=e.book,n=e.indicator;return Object(j.jsx)(i.j,{mode:"card",children:Object(j.jsxs)(i.E,{multiline:!0,disabled:!0,indicator:n,children:[Object(j.jsx)(i.n,{header:"\u0410\u0432\u0442\u043e\u0440\u044b",style:{marginBottom:10},children:t.Authors}),Object(j.jsx)(i.n,{header:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u0438\u0433\u0438",children:t.Title})]})})},z=function(e){var t=e.list;return Object(j.jsx)(i.j,{children:t.data.map((function(e){return Object(j.jsx)(D,{book:e,indicator:"\u0413\u043e\u0434 \u0438\u0437\u0434\u0430\u043d\u0438\u044f: ".concat(e.Publication_year)},e.Id)}))})},F=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){fetch("loda"+"/readers/".concat(e.readerId,"/books")).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return console.error(e)}))}),[e.readerId]),Object(j.jsxs)(i.p,{id:e.id,onClose:e.onCLose,children:[Object(j.jsxs)(i.q,{children:["\u0412\u044b\u0434\u0430\u043d\u043d\u044b\u0435 \u043a\u043d\u0438\u0433\u0438 ",r?"(".concat(r.count,")"):""]}),r?Object(j.jsx)(z,{list:r}):Object(j.jsx)(i.A,{})]})},G=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){fetch("loda"+"/readers/".concat(e.readerId,"/books?status=lost")).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return console.error(e)}))}),[e.readerId]),Object(j.jsxs)(i.p,{id:e.id,onClose:e.onCLose,children:[Object(j.jsxs)(i.q,{children:["\u041f\u043e\u0442\u0435\u0440\u044f\u043d\u043d\u044b\u0435 \u043a\u043d\u0438\u0433\u0438 ",r?"(".concat(r.count,")"):""]}),r?Object(j.jsx)(z,{list:r}):Object(j.jsx)(i.A,{})]})},J=function(e){var t,n=Object(c.useState)(null),r=Object(u.a)(n,2),o=r[0],a=r[1];return Object(j.jsxs)(i.p,{id:e.id,onClose:e.onClose,children:[Object(j.jsx)(i.q,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044f"}),null!==o&&void 0!==o?o:Object(j.jsx)(_,{props:null!==(t=e.props)&&void 0!==t?t:e,setPlaceholder:a})]})},U=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){return fetch("loda/readers/"+e.reader.Id).then((function(e){return e.json()})).then((function(e){var t=e.data;return o(t[0])})).catch((function(e){return console.error(e)}))}),[e.reader]),Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsx)(i.q,{children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435"}),r?Object(j.jsx)(q,{reader:r}):null]})};function H(e){var t=new Date(1e3*e);return"".concat(t.getDate(),".").concat(("0"+(t.getMonth()+1)).slice(-2),".").concat(t.getFullYear())}var W=function(e){var t=e.infraction,n=e.indicator;return Object(j.jsx)(i.j,{mode:"card",children:Object(j.jsxs)(i.E,{multiline:!0,disabled:!0,indicator:n,children:[Object(j.jsx)(i.n,{header:"\u041d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u0435",style:{marginBottom:10},children:t.Infraction}),Object(j.jsx)(i.n,{header:"\u0414\u0430\u0442\u0430 \u0432\u044b\u0434\u0430\u0447\u0438",children:H(t.Issue_date)})]})})},Y=function(e){var t=e.list;return Object(j.jsx)(i.j,{children:t.data.map((function(e){return Object(j.jsx)(W,{infraction:e,indicator:e.Is_active?"\u0410\u043a\u0442\u0438\u0432\u043d\u043e":""},e.Num)}))})},V=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){fetch("loda"+"/readers/".concat(e.readerId,"/infractions")).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return console.error(e)}))}),[e.readerId]),Object(j.jsxs)(i.p,{id:e.id,onClose:e.onCLose,children:[Object(j.jsxs)(i.q,{children:["\u0412\u044b\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f ",r?"(".concat(r.count,")"):""]}),r?Object(j.jsx)(Y,{list:r}):Object(j.jsx)(i.A,{})]})},K=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){fetch("loda"+"/readers/".concat(e.readerId,"/infractions?is_active=true")).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return console.error(e)}))}),[e.readerId]),Object(j.jsxs)(i.p,{id:e.id,onClose:e.onCLose,children:[Object(j.jsxs)(i.q,{children:["\u0412\u044b\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430\u0440\u0443\u0448\u0435\u043d\u0438\u044f ",r?"(".concat(r.count,")"):""]}),r?Object(j.jsx)(Y,{list:r}):Object(j.jsx)(i.A,{})]})},Q=function(e){return Object(j.jsxs)(i.r,{activeModal:e.activeModal,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsx)(J,{id:"addReader",onClose:function(){return e.setActiveModal(null)},setActiveModal:e.setActiveModal}),Object(j.jsx)(w,{id:"readerInfo",onClose:function(){return e.setActiveModal(null)},setActiveModal:e.setActiveModal,readerId:e.readerId}),Object(j.jsx)(F,{id:"issuedBooksList",onClose:function(){return e.setActiveModal("readerInfo")},readerId:e.readerId}),Object(j.jsx)(G,{id:"lostBooksList",onClose:function(){return e.setActiveModal("readerInfo")},readerId:e.readerId}),Object(j.jsx)(V,{id:"issuedInfractionsList",onClose:function(){return e.setActiveModal("readerInfo")},readerId:e.readerId}),Object(j.jsx)(K,{id:"activeInfractionsList",onClose:function(){return e.setActiveModal("readerInfo")},readerId:e.readerId}),Object(j.jsx)(U,{id:"userInformation",onClose:function(){return e.setActiveModal(null)},reader:e.user,setActiveModal:e.setActiveModal})]})},X=function(e){var t=e.setBody,n=Object(c.useState)(10),r=Object(u.a)(n,2),o=r[0],a=r[1],s=Object(c.useState)(""),l=Object(u.a)(s,2),d=l[0],O=l[1],h=Object(c.useState)(""),x=Object(u.a)(h,2),v=x[0],p=x[1],m=Object(c.useState)(""),k=Object(u.a)(m,2),C=k[0],I=k[1],S=Object(c.useState)(""),A=Object(u.a)(S,2),g=A[0],M=A[1],P=Object(c.useState)(""),E=Object(u.a)(P,2),R=E[0],_=E[1];return Object(j.jsxs)(i.h,{children:[Object(j.jsx)(f,{inputs:{debtPeriod:{value:o,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0435\u0440\u0438\u043e\u0434 \u0437\u0430\u0434\u043e\u043b\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0432 \u0434\u043d\u044f\u0445",onChange:a,type:"number"},libraryPoint:{value:d,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0443\u043d\u043a\u0442\u0430",onChange:O}},mode:"horizontal"}),Object(j.jsx)(y,{faculty:v,setFaculty:p,department:C,setDepartment:I,group:g,setGroup:M,role:R,setRole:_,universityMode:"horizontal"}),Object(j.jsx)(b,{onClick:function(){t({debtPeriod:""!==o?o:null,libraryPoint:""!==d?d:null,faculty:""!==v?v:null,department:""!==C?C:null,group:""!==g?g:null,role:""!==R?R:null})},disabled:o<0,size:"l",stretched:!0,mode:"primary",text:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"})]})},Z=function(e){var t=Object(c.useState)({}),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)(!0),O=Object(u.a)(b,2),f=O[0],h=O[1];return Object(c.useEffect)((function(){return fetch("loda/readers/debtors",{method:"POST",body:JSON.stringify(r)}).then((function(e){return e.json()})).then((function(e){d(e),h(!1)})).catch((function(e){console.error(e),h(!1)}))}),[r]),Object(j.jsxs)(i.t,{id:e.id,children:[Object(j.jsx)(i.u,{children:"\u0417\u0430\u0434\u043e\u043b\u0436\u043d\u0438\u043a\u0438"}),Object(j.jsxs)(i.j,{children:[f?Object(j.jsx)(i.A,{height:96,size:"large"}):l?Object(j.jsx)(X,{setBody:o}):Object(j.jsx)(i.B,{icon:Object(j.jsx)(x.a,{}),header:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445"}),l?Object(j.jsx)(A,{readerList:l,openReaderInfo:e.openReaderInfo}):null]})]})},$=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(j.jsx)(Q,{readerId:r,activeModal:e.activeModal,setActiveModal:e.setActiveModal,user:e.user});function s(t){o(t),e.setActiveModal("readerInfo")}return Object(j.jsxs)(i.J,{id:e.id,activePanel:e.activePanel,modal:a,children:[Object(j.jsx)(M,{id:"adminReaders",openReaderInfo:s,addReaderButtonClick:function(){return e.setActiveModal("addReader")}}),Object(j.jsx)(Z,{id:"adminDebtors",openReaderInfo:s})]})},ee=n(116),te=function(e){var t,n;return Object(j.jsx)(i.j,{mode:"plain",header:Object(j.jsxs)(i.k,{children:["\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ",null===(t=e.data)||void 0===t?void 0:t.count]}),children:null===(n=e.data)||void 0===n?void 0:n.data.map((function(t){return Object(j.jsx)(i.E,{disabled:e.disabled,onClick:function(){return e.openPointInfo(t)},indicator:t.Can_issue_books?"\u041c\u043e\u0436\u0435\u0442 \u0432\u044b\u0434\u0430\u0432\u0430\u0442\u044c \u043a\u043d\u0438\u0433\u0438":"",children:t.Name},t.Name)}))})},ne=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a="\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"===e.user.Role;return Object(c.useEffect)((function(){fetch("loda/library").then((function(e){return e.json()})).then((function(e){return o(e)}))}),[]),Object(j.jsxs)(i.t,{id:e.id,children:[Object(j.jsx)(i.u,{children:"\u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u0447\u043d\u044b\u0435 \u043f\u0443\u043d\u043a\u0442\u044b"}),Object(j.jsxs)(i.j,{children:[a?Object(j.jsx)(i.E,{onClick:e.openStatistics,indicator:Object(j.jsx)(ee.a,{}),children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435"}):null,r?Object(j.jsx)(te,{disabled:!a,openPointInfo:e.openPointInfo,data:r}):null]})]})},ce=n(117),re=function(e){var t,n=e.book,c=e.onClick;return Object(j.jsx)(i.j,{mode:"plain",children:Object(j.jsx)(i.E,{indicator:Object(j.jsx)(ce.a,{}),multiline:!0,onClick:function(){return c(n)},description:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e: ".concat(null!==(t=n.Available)&&void 0!==t?t:0),children:Object(j.jsx)(i.n,{header:n.Authors,children:Object(j.jsx)(i.I,{weight:"semibold",children:n.Title})})})})},oe=function(e){var t=e.header,n=e.books,c=e.onClick;return Object(j.jsx)(i.j,{header:t,mode:"plain",children:n?n.map((function(e,t){return Object(j.jsx)(re,{book:e,onClick:c},t)})):""})},ae=function(e){return Object(j.jsxs)(i.j,{mode:"plain",children:[Object(j.jsx)(i.h,{children:Object(j.jsxs)(i.i,{mode:"horizontal",children:[Object(j.jsx)(b,{size:"l",stretched:!0,text:"\u0422\u043e\u043f \u043a\u043d\u0438\u0433",onClick:function(){return e.setActiveModal("booksOrdersTop")}}),Object(j.jsx)(b,{size:"l",stretched:!0,text:"\u0417\u0430\u043a\u0430\u0437\u044b \u0437\u0430 \u043f\u0435\u0440\u0438\u043e\u0434",onClick:function(){return e.setActiveModal("booksOrdersPeriod")}})]})}),Object(j.jsx)(oe,{books:e.books,onClick:e.onClick,header:Object(j.jsxs)(i.k,{children:["\u041d\u0430\u0439\u0434\u0435\u043d\u043e: ",e.count]})})]})},ie=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(!0),s=Object(u.a)(a,2),l=s[0],d=s[1],b="\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"===e.user.Role;return Object(c.useEffect)((function(){fetch("loda/books").then((function(e){return e.json()})).then((function(t){o(Object(j.jsx)(ae,{setActiveModal:e.setActiveModal,count:t.count,books:t.data,onClick:e.openBookInfo})),d(!1)})).catch((function(e){console.error(e),o(Object(j.jsx)(i.B,{header:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445",icon:Object(j.jsx)(x.a,{})})),d(!1)}))}),[]),Object(j.jsxs)(i.t,{id:e.id,children:[Object(j.jsx)(i.u,{left:b?Object(j.jsx)(i.w,{onClick:e.addBookButtonClick,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u0438\u0433\u0443"}):null,children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043d\u0438\u0433"}),Object(j.jsx)(i.j,{children:l?Object(j.jsx)(i.A,{height:96,size:"large"}):r})]})};var se=function(e){var t,n,r,o,a,s=e.props,l=e.setPlaceholder,d=Object(c.useState)(null!==(t=s.title)&&void 0!==t?t:""),O=Object(u.a)(d,2),h=O[0],x=O[1],v=Object(c.useState)(null!==(n=s.authors)&&void 0!==n?n:""),p=Object(u.a)(v,2),m=p[0],k=p[1],C=Object(c.useState)(null!==(r=s.publisher)&&void 0!==r?r:""),y=Object(u.a)(C,2),I=y[0],S=y[1],A=Object(c.useState)(null!==(o=s.publicationYear)&&void 0!==o?o:0),g=Object(u.a)(A,2),M=g[0],P=g[1];return Object(j.jsxs)(i.h,{children:[Object(j.jsx)(f,{inputs:{add_title:{value:h,onChange:x,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u0438\u0433\u0438",required:!0},add_authors:{value:m,onChange:k,placeholder:"\u0410\u0432\u0442\u043e\u0440\u044b",required:!0},add_publisher:{value:I,onChange:S,placeholder:"\u0418\u0437\u0434\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u043e",required:!0},add_publicationYear:{status:M>0?"default":"error",value:M,onChange:P,placeholder:"\u0413\u043e\u0434 \u0438\u0437\u0434\u0430\u043d\u0438\u044f",required:!0,type:"number"}}}),Object(j.jsx)(b,{disabled:!(h&&m&&I&&M>0),mode:"primary",size:"l",text:null!==(a=s.text)&&void 0!==a?a:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u0438\u0433\u0443",onClick:function(){var e={title:document.getElementsByName("add_title")[0].value,authors:document.getElementsByName("add_authors")[0].value,publisher:document.getElementsByName("add_publisher")[0].value,publicationYear:document.getElementsByName("add_publicationYear")[0].value};s.onClick?s.onClick(e):function(e,t){fetch("loda/books",{method:"POST",body:JSON.stringify(e)}).then((function(e){return e.ok?t(Object(j.jsx)(i.B,{header:"\u041a\u043d\u0438\u0433\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430"})):t(Object(j.jsx)(i.B,{header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u0438\u0433\u0443 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433"}))}))}(e,l)},stretched:!0})]})},le=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsx)(i.q,{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043d\u0438\u0433\u0443 \u0432 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u0447\u043d\u044b\u0439 \u043a\u0430\u0442\u0430\u043b\u043e\u0433"}),r||Object(j.jsx)(se,{props:e,setPlaceholder:o})]})},ue=n(119),de=n(118),je=function(e){var t=e.book,n=Object(c.useState)(null),r=Object(u.a)(n,2),o=r[0],a=r[1];return Object(c.useEffect)((function(){return fetch("loda/books/issue-logs?book_id="+t.Id).then((function(e){return e.json()})).then((function(e){return a(e)}))}),[t]),o?Object(j.jsx)(i.j,{header:Object(j.jsxs)(i.k,{children:["\u0412\u044b\u0434\u0430\u043d\u043e \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432: ",o.count]}),children:o.data.map((function(e){return Object(j.jsx)(i.E,{multiline:!0,description:"\u0414\u043e\u043b\u0436\u0435\u043d \u0432\u0435\u0440\u043d\u0443\u0442\u044c ".concat(H(e.Return_date)),indicator:new Date(1e3*e.Return_date)<new Date?Object(j.jsx)(de.a,{}):null,children:Object(j.jsxs)(i.n,{header:"ID \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044f: ".concat(e.Id),children:[e.Surname," ",e.Name]})})}))}):null},be=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1];return null!==r&&void 0!==r?r:Object(j.jsxs)(i.j,{children:[Object(j.jsx)(se,{props:{title:e.book.Title,authors:e.book.Authors,publisher:e.book.Publisher,publicationYear:e.book.Publication_year,text:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e",onClick:function(t){fetch("loda/books/"+e.book.Id,{method:"PUT",body:JSON.stringify(t)}).then((function(e){return e.ok?o(Object(j.jsx)(i.B,{header:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430"})):o(Object(j.jsx)(i.B,{header:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e"}))})).catch((function(e){return o(Object(j.jsx)(R,{}))}))}}}),Object(j.jsx)(je,{book:e.book})]})},Oe=function(e){var t,n=e.userIsAdmin,c=e.publication,r=e.openBookInfo,o=e.openLibraryPointInfo;return Object(j.jsx)(i.E,{disabled:!0,before:n?Object(j.jsx)(i.m,{onClick:function(){return r(c)},children:Object(j.jsx)(ue.a,{})}):"",after:c.Available?Object(j.jsx)(i.m,{onClick:function(){return o(c.Library_point,c)},children:Object(j.jsx)(p.a,{})}):null,multiline:!0,description:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e: ".concat(null!==(t=c.Available)&&void 0!==t?t:0,", \u0438\u0437\u0434\u0430\u043d\u0438\u0435 ").concat(c.Publication_year," \u0433\u043e\u0434\u0430"),children:c.Library_point})},fe=function(e){var t=e.userIsAdmin,n=e.publications,c=e.openLibraryPointInfo,r=e.openBookInfo;return Object(j.jsx)(i.j,{children:n.data.map((function(e,n){return Object(j.jsx)(Oe,{userIsAdmin:t,publication:e,openBookInfo:r,openLibraryPointInfo:c},n)}))})},he=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)(null),O=Object(u.a)(b,2),f=O[0],h=O[1],x=Object(c.useState)(!1),v=Object(u.a)(x,2),p=v[0],m=v[1],k="\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"===e.user.Role;return Object(c.useEffect)((function(){fetch("loda"+"/books/publications?title=".concat(e.book.Title,"&authors=").concat(e.book.Authors)).then((function(e){return e.json()})).then((function(e){return o(e)}))}),[e.book,f]),Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsx)(i.q,{left:f?Object(j.jsx)(i.v,{onClick:function(){return h(null)}}):null,right:f?p?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(i.x,{onClick:function(){return m(!1)}}),Object(j.jsx)(i.z,{onClick:function(){fetch("loda/books/"+l.Id,{method:"DELETE"}).then((function(e){return h(null)})),m(!1)}})]}):Object(j.jsx)(i.w,{onClick:function(){return m(!0)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}):null,children:f?"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043d\u0438\u0433\u0435":"\u041f\u0443\u043d\u043a\u0442\u044b \u0441 \u0434\u0430\u043d\u043d\u043e\u0439 \u043a\u043d\u0438\u0433\u043e\u0439 \u0432 \u043d\u0430\u043b\u0438\u0447\u0438\u0438"}),r?null!==f&&void 0!==f?f:Object(j.jsx)(fe,{userIsAdmin:k,publications:r,openBookInfo:function(e){d(e),h(Object(j.jsx)(be,{book:e}))},openLibraryPointInfo:e.openLibraryPointInfo}):null]})},xe=function(e){var t=e.readers;return Object(j.jsx)(i.j,{children:t.map((function(e){return Object(j.jsx)(i.E,{disabled:!0,multiline:!0,children:Object(j.jsxs)(i.n,{header:"ID: ".concat(e.Id,", ").concat(e.Role),children:[e.Surname," ",e.Name]},e.Id)})}))})},ve=function(e){var t=e.books;return Object(j.jsx)(i.j,{children:t.map((function(e){return Object(j.jsx)(D,{book:e,indicator:"\u0417\u0430\u043a\u0430\u0437\u043e\u0432: ".concat(e.Taken)},e.Id)}))})},pe=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)(null),O=Object(u.a)(b,2),f=O[0],h=O[1];return Object(c.useEffect)((function(){return fetch("loda"+"/library/".concat(e.point.Name,"/readers")).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return console.error(e)}))}),[e.point]),Object(c.useEffect)((function(){return fetch("loda/books/orders/top?param=library_point&param_name="+e.point.Name).then((function(e){return e.json()})).then((function(e){return d(e)}))}),[e.point]),Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsx)(i.q,{children:e.point.Name}),Object(j.jsxs)(i.j,{children:[r?Object(j.jsx)(i.E,{disabled:0===r.count,onClick:function(){return h(Object(j.jsx)(xe,{readers:r.data}))},indicator:r.count,children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"}):null,l?Object(j.jsx)(i.E,{disabled:0===l.count,onClick:function(){return h(Object(j.jsx)(ve,{books:l.data}))},indicator:l.count,children:"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u043e\u043f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}):null]}),null!==f&&void 0!==f?f:null]})};var me=function(e){var t=e.book,n=e.point,c=e.user,r=e.onReserveBook;return Object(j.jsxs)(i.j,{children:[Object(j.jsx)(i.E,{disabled:!0,description:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0443\u043d\u043a\u0442\u0430",children:n.Name}),Object(j.jsx)(i.E,{disabled:!0,description:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u0438\u0433\u0438",children:t.Title}),Object(j.jsx)(i.E,{disabled:!0,description:"\u0410\u0432\u0442\u043e\u0440\u044b",children:t.Authors}),Object(j.jsx)(i.E,{disabled:!0,indicator:t.Available,children:"\u0414\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043a\u043d\u0438\u0433"}),Object(j.jsx)(i.h,{children:Object(j.jsx)(b,{stretched:!0,mode:"primary",disabled:!n.Can_issue_books||"\u0410\u0431\u0438\u0442\u0443\u0440\u0438\u0435\u043d\u0442"===c.Role,onClick:r,size:"l",text:n.Can_issue_books?"\u0410\u0431\u0438\u0442\u0443\u0440\u0438\u0435\u043d\u0442"===c.Role?"\u0412\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u043d\u0438\u0433\u0438":"\u0417\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440":"\u041f\u0443\u043d\u043a\u0442 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0432\u044b\u0434\u0430\u0432\u0430\u0442\u044c \u043a\u043d\u0438\u0433\u0438"})})]})},ke=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1];return Object(c.useEffect)((function(){fetch("loda"+"/library/".concat(e.libraryPoint)).then((function(e){return e.json()})).then((function(e){var t=e.data;return o(t[0])})).catch((function(e){return console.error(e)}))}),[e.libraryPoint]),Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal("bookInfo")},children:[Object(j.jsx)(i.q,{left:Object(j.jsx)(i.v,{onClick:function(){return e.setActiveModal("bookInfo")}}),children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u0447\u043d\u043e\u043c \u043f\u0443\u043d\u043a\u0442\u0435"}),l||Object(j.jsx)(i.j,{children:r?Object(j.jsx)(me,{book:e.book,point:r,user:e.user,onReserveBook:function(){return function(e,t,n,c){fetch("loda/library/"+t.Name+"/reserve",{method:"POST",body:JSON.stringify({bookId:e.Id,libraryPoint:t.Name,readerId:n.Id})}).then((function(e){return c(e.ok?Object(j.jsx)(i.B,{header:"\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d"}):Object(j.jsx)(i.B,{header:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0435, \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435"}))}))}(e.book,r,e.user,d)}}):Object(j.jsx)(i.A,{size:56})})]})},Ce=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1];return Object(c.useEffect)((function(){return fetch("loda/books/orders/top?param="+(""!==r?"faculty":" ")+"&param_name="+r).then((function(e){return e.json()})).then((function(e){return d(Object(j.jsx)(ve,{books:e.data}))}))}),[r]),Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsx)(i.q,{children:"\u0422\u043e\u043f \u043a\u043d\u0438\u0433 \u043f\u043e \u0432\u0443\u0437\u0443 \u0438 \u0444\u0430\u043a\u0443\u043b\u044c\u0442\u0435\u0442\u0430\u043c"}),Object(j.jsx)(C,{faculty:r,setFaculty:o,facultyOnly:!0}),l||null]})},ye=function(e){var t=Object(c.useState)(31),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1];return Object(c.useEffect)((function(){return fetch("loda"+"/books/orders?order_period=".concat(r)).then((function(e){return e.json()})).then((function(e){return d(Object(j.jsx)(ve,{books:e.data}))}))}),[r]),Object(j.jsxs)(i.p,{id:e.id,onClose:function(){return e.setActiveModal(null)},children:[Object(j.jsxs)(i.q,{children:["\u0417\u0430\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043a\u043d\u0438\u0433\u0438 \u0437\u0430 \u043f\u0435\u0440\u0438\u043e\u0434 \u0432 \u0434\u043d\u044f\u0445: ",r]}),Object(j.jsx)(O,{value:r,onChange:o,placeholder:"\u041f\u0435\u0440\u0438\u043e\u0434 \u0437\u0430\u043a\u0430\u0437\u043e\u0432, \u0432 \u0434\u043d\u044f\u0445",type:"number",required:!0}),l||null]})};function Ie(e,t){fetch("loda/library/statistics?stat_kind="+e).then((function(e){return e.json()})).then((function(e){return t(e)}))}var Se=function(e){var t,n,c,r;return Object(j.jsxs)(i.j,{children:[Object(j.jsx)(i.E,{onClick:function(){return e.setList(e.minReaders)},indicator:null===(t=e.minReaders)||void 0===t?void 0:t.count,children:"\u041f\u0443\u043d\u043a\u0442\u044b \u0441 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u0447\u0438\u0441\u043b\u043e\u043c \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"}),Object(j.jsx)(i.E,{onClick:function(){return e.setList(e.maxReaders)},indicator:null===(n=e.maxReaders)||void 0===n?void 0:n.count,children:"\u041f\u0443\u043d\u043a\u0442\u044b \u0441 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u0447\u0438\u0441\u043b\u043e\u043c \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u0435\u0439"}),Object(j.jsx)(i.E,{onClick:function(){return e.setList(e.minDebits)},indicator:null===(c=e.minDebits)||void 0===c?void 0:c.count,children:"\u041f\u0443\u043d\u043a\u0442\u044b \u0441 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u0447\u0438\u0441\u043b\u043e\u043c \u0437\u0430\u0434\u043e\u043b\u0436\u043d\u0438\u043a\u043e\u0432"}),Object(j.jsx)(i.E,{onClick:function(){return e.setList(e.maxDebits)},indicator:null===(r=e.maxDebits)||void 0===r?void 0:r.count,children:"\u041f\u0443\u043d\u043a\u0442\u044b \u0441 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u043c \u0447\u0438\u0441\u043b\u043e\u043c \u0437\u0430\u0434\u043e\u043b\u0436\u043d\u0438\u043a\u043e\u0432"})]})},Ae=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)(null),O=Object(u.a)(b,2),f=O[0],h=O[1],x=Object(c.useState)(null),v=Object(u.a)(x,2),p=v[0],m=v[1],k=Object(c.useState)(null),C=Object(u.a)(k,2),y=C[0],I=C[1],S=Object(c.useState)(!0),A=Object(u.a)(S,2),g=A[0],M=A[1];return Object(c.useEffect)((function(){Ie("min_debitors",h),Ie("min_readers",o),Ie("max_debitors",m),Ie("max_readers",d),M(!1)}),[]),Object(j.jsxs)(i.p,{id:e.id,onClose:e.onClose,children:[Object(j.jsx)(i.q,{children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u043f\u043e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435"}),g?Object(j.jsx)(i.A,{}):Object(j.jsx)(Se,{setList:I,minReaders:r,maxReaders:l,minDebits:f,maxDebits:p}),y?Object(j.jsx)(i.j,{children:y.data.map((function(e){var t;return Object(j.jsx)(i.E,{disabled:!0,indicator:null!==(t=null===e||void 0===e?void 0:e.Readers)&&void 0!==t?t:null===e||void 0===e?void 0:e.Debitors,children:e.Name},e.Name)}))}):null]})},ge=function(e){var t=function(){return e.setActiveModal(null)};return Object(j.jsxs)(i.r,{activeModal:e.activeModal,onClose:t,children:[Object(j.jsx)(he,{user:e.user,id:"bookInfo",setActiveModal:e.setActiveModal,book:e.book,openLibraryPointInfo:e.openLibraryPointInfo}),Object(j.jsx)(ke,{id:"libraryPointInfo",setActiveModal:e.setActiveModal,book:e.book,libraryPoint:e.libraryPoint,user:e.user}),Object(j.jsx)(pe,{id:"additionalLibraryPoint",setActiveModal:e.setActiveModal,point:e.libraryPoint}),Object(j.jsx)(le,{id:"addBook",setActiveModal:e.setActiveModal}),Object(j.jsx)(U,{id:"userInformation",reader:e.user,onClose:t,setActiveModal:e.setActiveModal}),Object(j.jsx)(Ce,{id:"booksOrdersTop",onClose:t,setActiveModal:e.setActiveModal}),Object(j.jsx)(ye,{id:"booksOrdersPeriod",onClose:t,setActiveModal:e.setActiveModal}),Object(j.jsx)(Ae,{id:"statistics",onClose:t})]})},Me=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)(null),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(j.jsx)(ge,{activeModal:e.activeModal,setActiveModal:e.setActiveModal,book:r,libraryPoint:l,user:e.user,openLibraryPointInfo:function(t,n){o(n),d(t),e.setActiveModal("libraryPointInfo")}});return Object(j.jsxs)(i.J,{activePanel:e.activePanel,id:e.id,modal:b,children:[Object(j.jsx)(ie,{setActiveModal:e.setActiveModal,id:"publicBooks",openBookInfo:function(t){o(t),e.setActiveModal("bookInfo")},user:e.user,addBookButtonClick:function(){return e.setActiveModal("addBook")}}),Object(j.jsx)(ne,{openStatistics:function(){return e.setActiveModal("statistics")},id:"publicLibraryPoints",user:e.user,openPointInfo:function(t){d(t),e.setActiveModal("additionalLibraryPoint")}})]})},Pe=function(e){var t="\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"===e.user.Role;return Object(j.jsxs)(i.D,{activeView:e.activeView,children:[Object(j.jsx)(Me,{user:e.user,id:"publicContent",activePanel:e.activePanel,activeModal:e.activeModal,setActiveModal:e.setActiveModal}),t?Object(j.jsx)($,{user:e.user,id:"adminContent",activePanel:e.activePanel,activeModal:e.activeModal,setActiveModal:e.setActiveModal}):null]})},Ee=function(e){var t=e.panel,n=e.activePanel,c=e.onClick,r=e.cellText,o=e.view;return Object(j.jsx)(i.d,{disabled:t===n,style:t===n?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-view":o,"data-panel":t,onClick:c,children:r},t)},Re={adminReaders:"\u0427\u0438\u0442\u0430\u0442\u0435\u043b\u0438",adminDebtors:"\u0417\u0430\u0434\u043e\u043b\u0436\u043d\u0438\u043a\u0438"},_e=function(e){return Object(j.jsx)(i.j,{mode:"plain",children:Object.keys(Re).map((function(t){return Object(j.jsx)(Ee,{view:"adminContent",panel:t,activePanel:e.activePanel,onClick:e.onClick,cellText:Re[t]},t)}))})},Ne={publicBooks:"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043d\u0438\u0433",publicLibraryPoints:"\u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u0447\u043d\u044b\u0435 \u043f\u0443\u043d\u043a\u0442\u044b"},Be=function(e){var t=e.activePanel,n=e.onClick;return Object(j.jsx)(i.j,{mode:"plain",children:Object.keys(Ne).map((function(e){return Object(j.jsx)(Ee,{panel:e,activePanel:t,cellText:Ne[e],onClick:n,view:"publicContent"},e)}))})},Le=function(e){var t=e.activePanel,n=e.onClick,c=e.userIsAdmin;return Object(j.jsxs)(i.j,{mode:"plain",separator:"auto",children:[Object(j.jsx)(Be,{activePanel:t,onClick:n}),c?Object(j.jsx)(_e,{activePanel:t,onClick:n}):null]})},qe=n(120),Te=n(121),we=function(e){var t=e.user,n=e.openUserInfo,c=e.onLogout;return Object(j.jsx)(i.j,{mode:"plain",separator:"auto",children:Object(j.jsx)(i.E,{disabled:!0,multiline:!0,after:Object(j.jsxs)(j.Fragment,{children:[n?Object(j.jsx)(i.m,{"aria-label":"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:n,children:Object(j.jsx)(qe.a,{})}):null,Object(j.jsx)(i.m,{"aria-label":"\u0412\u044b\u0445\u043e\u0434",onClick:c,children:Object(j.jsx)(Te.a,{})})]}),description:t.Role,children:"".concat(t.Surname," ").concat(t.Name)})})},De=function(e){var t="\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"===e.user.Role;return Object(j.jsx)(i.t,{children:Object(j.jsxs)(i.j,{children:[Object(j.jsx)(we,{user:e.user,openUserInfo:e.openUserInfo,onLogout:e.onLogout}),Object(j.jsx)(Le,{activePanel:e.activePanel,onClick:e.onClick,userIsAdmin:t})]})})},ze=function(e){var t=Object(c.useState)("publicContent"),n=Object(u.a)(t,2),r=n[0],o=n[1],a=Object(c.useState)("publicBooks"),s=Object(u.a)(a,2),l=s[0],d=s[1],b=Object(c.useState)(null),O=Object(u.a)(b,2),f=O[0],h=O[1];return Object(j.jsxs)(i.H,{style:{justifyContent:"center"},children:[Object(j.jsx)(i.G,{fixed:!0,width:"250px",maxWidth:"250px",children:Object(j.jsx)(De,{user:e.user,activePanel:l,onClick:function(e){o(e.currentTarget.dataset.view),d(e.currentTarget.dataset.panel)},onLogout:e.onLogout})}),Object(j.jsx)(i.G,{animate:!1,spaced:!0,width:"560px",maxWidth:"900px",children:Object(j.jsx)(Pe,{activeModal:f,setActiveModal:h,activePanel:l,activeView:r,user:e.user,setActivePanel:d})})]})};function Fe(){return(Fe=Object(d.a)(l.a.mark((function e(t,n){var c,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("loda/users/auth",{method:"POST",body:JSON.stringify({username:t,password:n})});case 2:return c=e.sent,e.next=5,c.json();case 5:return r=e.sent,e.abrupt("return",r.data[0]);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ge=function(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){console.log(Object({NODE_ENV:"production",PUBLIC_URL:"/library-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_HOST:"loda"})),fetch("loda/users/auth",{method:"GET"}).then((function(e){return e.json()})).then((function(e){var t=e.data;t&&r(t)}))}),[n]);return n?Object(j.jsx)(ze,{onLogout:function(){return r(null)},user:n}):Object(j.jsx)(v,{onButtonClick:function(e,t){return function(e,t){return Fe.apply(this,arguments)}(e,t).then((function(e){return r(e)}))},style:{justifyContent:"center"}})},Je=function(){return Object(j.jsx)(i.f,{platform:i.C.VKCOM,children:Object(j.jsx)(i.a,{children:Object(j.jsx)(i.b,{children:Object(j.jsx)(Ge,{})})})})};a.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(Je,{})}),document.getElementById("root"))}},[[111,1,2]]]);
//# sourceMappingURL=main.58c7aa54.chunk.js.map